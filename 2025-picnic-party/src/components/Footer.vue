<script setup lang="ts">
  import { ref, onMounted, onUnmounted } from 'vue'
  import gsap from 'gsap'

  const isVisible = ref(false)
  let headerHeight = 0
  let scrollTimer = null

  // **滾動事件**
  const handleScroll = () => {
    if (scrollTimer) return // 避免短時間內頻繁觸發
    scrollTimer = requestAnimationFrame(() => {
      const scrollY = window.scrollY || window.pageYOffset
      isVisible.value = scrollY > headerHeight + 200
      scrollTimer = null
    })
  }

  const updateHeaderHeight = () => {
    const header = document.querySelector('.header')
    headerHeight = header ? header.offsetHeight : 0
  }

  const goTop = () => {
    window.scrollTo({ top: 0, behavior: 'smooth' })
  }

  onMounted(() => {
    updateHeaderHeight()
    window.addEventListener('scroll', handleScroll, { passive: true })
    window.addEventListener('resize', updateHeaderHeight)

    gsap.to('.scale-bounce', {
      scale: 1.08,
      repeat: -1,
      yoyo: true,
      ease: 'elastic.inOut(.2, 0.5)',
      duration: 1.2
    })
  })

  onUnmounted(() => {
    window.removeEventListener('scroll', handleScroll)
    window.removeEventListener('resize', updateHeaderHeight)
  })
</script>
<template>
  <footer class="bg-primary-500 text-white">
    <div class="container">
      <div class="py-4">
        <div class="text-center">
          <div class="text-sm">
            <ul
              class="flex flex-wrap justify-center gap-y-1 divide-x text-center md:mx-0 md:flex-nowrap md:text-start"
            >
              <li class="px-2">
                <a
                  href="https://futureparenting.cwgv.com.tw/"
                  title="未來親子學習平台"
                  target="_blank"
                  >未來親子</a
                >
              </li>
              <li class="px-2">
                <a
                  href="https://futureparenting.cwgv.com.tw/kids"
                  title="小天下．未來出版"
                  target="_blank"
                  >小天下．未來出版</a
                >
              </li>
              <li class="px-2">
                <a
                  href="https://futureparenting.cwgv.com.tw/junior"
                  title="未來兒童"
                  target="_blank"
                  >未來兒童
                </a>
              </li>
              <li class="px-2">
                <a
                  href="https://futureparenting.cwgv.com.tw/youth"
                  title="未來少年"
                  target="_blank"
                  >未來少年</a
                >
              </li>
              <li class="px-2">
                <a
                  href="https://futureacademy.cwgv.com.tw/"
                  title="線上學院"
                  target="_blank"
                  >線上學院</a
                >
              </li>
            </ul>
            <div class="mt-3">
              服務專線：(02)2662-0012 服務時間：週一~週五 9:00~12:30 13:30~17:00
            </div>
            <div>
              Copyright© 1999~2025 遠見天下文化出版股份有限公司. All rights
            </div>
            <ul class="mt-5 flex items-center justify-center gap-5">
              <li class="text-white transition hover:text-[#fdfdac]">
                <a
                  href="https://www.facebook.com/globalfuturefamily"
                  target="_blank"
                >
                  <svg
                    width="30"
                    height="30"
                    viewBox="0 0 30 30"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      fill-rule="evenodd"
                      clip-rule="evenodd"
                      d="M15 0C6.71573 0 0 6.71573 0 15C0 23.2843 6.71573 30 15 30C23.2843 30 30 23.2843 30 15C30 6.71573 23.2843 0 15 0ZM16.5635 15.6589V23.8197H13.1869V15.6592H11.5V12.8469H13.1869V11.1585C13.1869 8.86425 14.1395 7.5 16.8457 7.5H19.0988V10.3126H17.6905C16.637 10.3126 16.5673 10.7056 16.5673 11.4391L16.5635 12.8466H19.1147L18.8162 15.6589H16.5635Z"
                      fill="currentColor"
                    />
                  </svg>
                </a>
              </li>
              <li class="text-white transition hover:text-[#fdfdac]">
                <a
                  href="https://www.instagram.com/futureparenting/"
                  target="_blank"
                >
                  <svg
                    width="30"
                    height="30"
                    viewBox="0 0 30 30"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      fill-rule="evenodd"
                      clip-rule="evenodd"
                      d="M15 0C6.71573 0 0 6.71573 0 15C0 23.2843 6.71573 30 15 30C23.2843 30 30 23.2843 30 15C30 6.71573 23.2843 0 15 0ZM11.702 7.04833C12.5554 7.0095 12.8281 7 15.0007 7H14.9983C17.1716 7 17.4433 7.0095 18.2966 7.04833C19.1483 7.08733 19.73 7.22217 20.24 7.42C20.7666 7.62417 21.2116 7.89751 21.6567 8.34251C22.1017 8.78719 22.375 9.23352 22.58 9.7597C22.7767 10.2684 22.9117 10.8497 22.9517 11.7014C22.99 12.5547 23 12.8274 23 15.0001C23 17.1728 22.99 17.4448 22.9517 18.2981C22.9117 19.1495 22.7767 19.731 22.58 20.2398C22.375 20.7658 22.1017 21.2121 21.6567 21.6568C21.2121 22.1018 20.7665 22.3758 20.2405 22.5802C19.7315 22.778 19.1495 22.9128 18.2978 22.9518C17.4444 22.9907 17.1726 23.0002 14.9998 23.0002C12.8272 23.0002 12.5547 22.9907 11.7014 22.9518C10.8499 22.9128 10.2684 22.778 9.75936 22.5802C9.23352 22.3758 8.78719 22.1018 8.34268 21.6568C7.89784 21.2121 7.62451 20.7658 7.42 20.2396C7.22234 19.731 7.0875 19.1496 7.04833 18.298C7.00967 17.4446 7 17.1728 7 15.0001C7 12.8274 7.01 12.5546 7.04817 11.7012C7.0865 10.8499 7.2215 10.2684 7.41984 9.75953C7.62484 9.23352 7.89818 8.78719 8.34318 8.34251C8.78785 7.89768 9.23419 7.62434 9.76036 7.42C10.269 7.22217 10.8504 7.08733 11.702 7.04833Z"
                      fill="currentColor"
                    />
                    <path
                      fill-rule="evenodd"
                      clip-rule="evenodd"
                      d="M14.283 8.44145C14.4224 8.44124 14.5723 8.4413 14.7341 8.44137L15.0007 8.44145C17.1367 8.44145 17.3899 8.44912 18.2334 8.48745C19.0134 8.52312 19.4368 8.65346 19.7188 8.76296C20.0921 8.90796 20.3583 9.08129 20.6381 9.3613C20.9181 9.6413 21.0915 9.90797 21.2368 10.2813C21.3463 10.563 21.4768 10.9863 21.5123 11.7663C21.5506 12.6097 21.559 12.863 21.559 14.998C21.559 17.133 21.5506 17.3864 21.5123 18.2297C21.4766 19.0097 21.3463 19.4331 21.2368 19.7147C21.0918 20.0881 20.9181 20.3539 20.6381 20.6337C20.3581 20.9137 20.0923 21.0871 19.7188 21.2321C19.4371 21.3421 19.0134 21.4721 18.2334 21.5078C17.3901 21.5461 17.1367 21.5544 15.0007 21.5544C12.8645 21.5544 12.6114 21.5461 11.768 21.5078C10.988 21.4718 10.5647 21.3414 10.2825 21.2319C9.90917 21.0869 9.6425 20.9136 9.3625 20.6336C9.0825 20.3536 8.90916 20.0876 8.76383 19.7141C8.65432 19.4324 8.52382 19.0091 8.48832 18.2291C8.44999 17.3857 8.44232 17.1324 8.44232 14.996C8.44232 12.8597 8.44999 12.6077 8.48832 11.7643C8.52399 10.9843 8.65432 10.561 8.76383 10.279C8.90883 9.90563 9.0825 9.63897 9.3625 9.35896C9.6425 9.07896 9.90917 8.90562 10.2825 8.76029C10.5645 8.65029 10.988 8.52029 11.768 8.48445C12.506 8.45112 12.792 8.44112 14.283 8.43945V8.44145ZM19.2711 9.7698C18.7411 9.7698 18.3111 10.1993 18.3111 10.7295C18.3111 11.2595 18.7411 11.6895 19.2711 11.6895C19.8011 11.6895 20.2311 11.2595 20.2311 10.7295C20.2311 10.1995 19.8011 9.76947 19.2711 9.76947V9.7698ZM10.8923 14.9999C10.8923 12.7311 12.7318 10.8916 15.0006 10.8915C17.2694 10.8915 19.1084 12.731 19.1084 14.9999C19.1084 17.2687 17.2696 19.1074 15.0007 19.1074C12.7319 19.1074 10.8923 17.2687 10.8923 14.9999Z"
                      fill="currentColor"
                    />
                    <path
                      d="M15.0007 12.3335C16.4734 12.3335 17.6674 13.5273 17.6674 15.0002C17.6674 16.4729 16.4734 17.6669 15.0007 17.6669C13.5279 17.6669 12.334 16.4729 12.334 15.0002C12.334 13.5273 13.5279 12.3335 15.0007 12.3335Z"
                      fill="currentColor"
                    />
                  </svg>
                </a>
              </li>
              <li class="text-white transition hover:text-[#fdfdac]">
                <a
                  href="https://page.line.me/vuh1823r?openQrModal=true"
                  target="_blank"
                >
                  <svg
                    width="30"
                    height="30"
                    viewBox="0 0 30 30"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      fill-rule="evenodd"
                      clip-rule="evenodd"
                      d="M15 0C6.71573 0 0 6.71573 0 15C0 23.2843 6.71573 30 15 30C23.2843 30 30 23.2843 30 15C30 6.71573 23.2843 0 15 0ZM15.2499 7C20.3506 7 24.5 10.3431 24.5 14.4523C24.5 16.097 23.8579 17.578 22.5173 19.0374H22.5177C20.5771 21.2551 16.2372 23.9561 15.2499 24.3691C14.2905 24.7706 14.4013 24.1432 14.4452 23.8945C14.4464 23.8874 14.4476 23.8806 14.4488 23.8741C14.4722 23.7361 14.5807 23.0881 14.5807 23.0881C14.6119 22.8536 14.6442 22.4899 14.5509 22.2577C14.4472 22.002 14.0372 21.8693 13.7359 21.8049C9.29077 21.2214 6 18.1363 6 14.4523C6 10.3431 10.1499 7 15.2499 7Z"
                      fill="currentColor"
                    />
                    <path
                      d="M13.3215 12.5H12.6787C12.5801 12.5 12.5 12.5827 12.5 12.6843V16.8157C12.5 16.9175 12.5801 17 12.6787 17H13.3215C13.4201 17 13.5 16.9175 13.5 16.8157V12.6843C13.5 12.5827 13.4201 12.5 13.3215 12.5Z"
                      fill="currentColor"
                    />
                    <path
                      d="M17.8121 12.5H17.1354C17.0316 12.5 16.9475 12.5827 16.9475 12.6843V15.1388L15.0211 12.582C15.0166 12.5754 15.0117 12.5693 15.0065 12.5633L15.0052 12.5622C15.0015 12.558 14.9978 12.5543 14.9939 12.5507C14.9928 12.5496 14.9917 12.5487 14.9904 12.5476C14.9872 12.5447 14.9839 12.542 14.9804 12.5394C14.9789 12.538 14.9773 12.5369 14.9756 12.5356C14.9723 12.5334 14.9691 12.5311 14.9658 12.5291C14.9639 12.5278 14.9621 12.5267 14.9601 12.5258C14.9567 12.5238 14.9534 12.5218 14.9501 12.5202C14.948 12.5193 14.9462 12.5182 14.9441 12.5174C14.9406 12.5158 14.9371 12.5142 14.9334 12.5129C14.9312 12.5122 14.9294 12.5115 14.9273 12.5107C14.9236 12.5095 14.9199 12.5082 14.916 12.5073C14.914 12.5065 14.9118 12.5062 14.9096 12.5055C14.9059 12.5047 14.9023 12.5038 14.8988 12.5031C14.8962 12.5027 14.8935 12.5024 14.8909 12.5022C14.8876 12.5015 14.8842 12.5013 14.8809 12.5009C14.8778 12.5005 14.8746 12.5005 14.8713 12.5004C14.8689 12.5004 14.867 12.5 14.8646 12.5H14.1881C14.0843 12.5 14 12.5827 14 12.6843V16.8157C14 16.9175 14.0843 17 14.1881 17H14.8646C14.9686 17 15.0527 16.9175 15.0527 16.8157V14.3619L16.9815 16.922C16.9948 16.9406 17.0113 16.9557 17.0292 16.9676C17.0298 16.968 17.0305 16.9686 17.0311 16.9691C17.035 16.9715 17.0388 16.9738 17.0427 16.976C17.0446 16.9771 17.0462 16.9778 17.0481 16.9787C17.0509 16.9804 17.054 16.9818 17.057 16.9831C17.0601 16.9844 17.0629 16.9856 17.0662 16.9869C17.0681 16.9876 17.0699 16.9884 17.0718 16.9889C17.0762 16.9905 17.0803 16.9918 17.0845 16.9931C17.0854 16.9931 17.0864 16.9935 17.0873 16.9936C17.1026 16.9976 17.1187 17 17.1354 17H17.8121C17.916 17 18 16.9175 18 16.8157V12.6843C18 12.5827 17.916 12.5 17.8121 12.5Z"
                      fill="currentColor"
                    />
                    <path
                      d="M11.8173 15.9655H10.0256V12.6847C10.0256 12.5827 9.94359 12.5 9.84267 12.5H9.1831C9.082 12.5 9 12.5827 9 12.6847V16.8152V16.8155C9 16.8651 9.01964 16.91 9.05118 16.9431C9.0519 16.944 9.05262 16.9449 9.0537 16.9458C9.0546 16.9467 9.05551 16.9475 9.05641 16.9484C9.08939 16.9804 9.13372 17 9.18292 17H11.8173C11.9184 17 12 16.9171 12 16.8152V16.1501C12 16.0482 11.9184 15.9655 11.8173 15.9655Z"
                      fill="currentColor"
                    />
                    <path
                      d="M21.3173 13.5345C21.4184 13.5345 21.5 13.452 21.5 13.3499V12.6848C21.5 12.5829 21.4184 12.5 21.3173 12.5H18.6831H18.6827C18.6334 12.5 18.5888 12.52 18.5559 12.5522C18.5551 12.5529 18.5542 12.5534 18.5537 12.5542C18.5526 12.5553 18.5517 12.5563 18.5508 12.5574C18.5195 12.5905 18.5 12.6352 18.5 12.6847V12.6848V16.8153V16.8155C18.5 16.8651 18.5196 16.91 18.5512 16.9431C18.5519 16.944 18.5528 16.9451 18.5537 16.9458C18.5544 16.9467 18.5555 16.9477 18.5564 16.9484C18.5892 16.9802 18.6337 17 18.6827 17H21.3173C21.4184 17 21.5 16.9171 21.5 16.8153V16.1501C21.5 16.0483 21.4184 15.9655 21.3173 15.9655H19.5258V15.2672H21.3173C21.4184 15.2672 21.5 15.1845 21.5 15.0825V14.4175C21.5 14.3155 21.4184 14.2326 21.3173 14.2326H19.5258V13.5345H21.3173Z"
                      fill="currentColor"
                    />
                  </svg>
                </a>
              </li>
            </ul>
          </div>
        </div>
        <div
          class="fixed bottom-20 end-3 z-30 flex flex-col items-center justify-center transition-opacity duration-300"
        >
          <router-link to="/#purchase" class="scroll-animate-rubberBand">
            <img width="80" src="/img/fixed-buy-02.svg" alt="" />
          </router-link>
        </div>

        <div
          class="fixed bottom-0 end-3 z-30 flex flex-col items-center justify-center transition-opacity duration-300"
          :class="{
            'pointer-events-auto opacity-100': isVisible,
            'pointer-events-none opacity-0': !isVisible
          }"
        >
          <div @click="goTop" class="mt-5 h-[65px] w-[65px] cursor-pointer">
            <img src="/img/gotop.svg" alt="" />
          </div>
        </div>
      </div>
    </div>
  </footer>
</template>
